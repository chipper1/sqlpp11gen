# Sqlpp11gen

sqlpp11gen is a c++ table class generator for [sqlpp11](https://github.com/rbock/sqlpp11).

NOTE: This gem is not published yet, but you can install it manually. Someday I will fix it. If you're familiar with ruby gems, you can help fix it.

## Installation

### Manual install

1. download the source code and copy `app` folder to the 'app' folder of your Rails project.

2. add a route in config/routes.rb

``` ruby
# config/routes.rb
resources :cxxes
```

3. register a new MIME type in config/initializers/mime_types.rb
```ruby
# config/initializers/mime_types.rb
Mime::Type.register "text/plain", :h
```

That's it! Now ignite your rails app!

## Usage

Assume that a 'users' table already exists, browse 'http://localhost:3000/cxxes.h'. 

If not, browse 'http://localhost:3000/cxxes?model=<ModelName>'. e.g. the model name is Product, browse 'http://localhost:3000/cxxes?model=Product'

Some sample outputs:

```c++
// WARNING; don't change this file manually. This file is generated by sqlpp11gen!
#ifndef SQLPP_TAB_USER_H
#define SQLPP_TAB_USER_H

#include <sqlpp11/table.h>
#include <sqlpp11/char_sequence.h>
#include <sqlpp11/column_types.h>

//
// table: User
// fields: 5
//   id                             integer    false      integer
//   name                           string     true       varchar
//   value                          string     true       varchar
//   created_at                     datetime   false      datetime
//   updated_at                     datetime   false      datetime
//

namespace TabUser_ {
  struct Id {
    struct _alias_t {
      static constexpr const char _literal[] = "id";
      using _name_t = sqlpp::make_char_sequence<sizeof(_literal), _literal>;
      template <typename T>
      struct _member_t {
        T id;
        T& operator()() { return id; }
        const T& operator()() const { return id; }
      };
    };
    using _traits = sqlpp::make_traits<sqlpp::integer>;
  };
  struct Name {
    struct _alias_t {
      static constexpr const char _literal[] = "name";
      using _name_t = sqlpp::make_char_sequence<sizeof(_literal), _literal>;
      template <typename T>
      struct _member_t {
        T name;
        T& operator()() { return name; }
        const T& operator()() const { return name; }
      };
    };
    using _traits = sqlpp::make_traits<sqlpp::varchar, sqlpp::tag::can_be_null>;
  };
  struct Value {
    struct _alias_t {
      static constexpr const char _literal[] = "value";
      using _name_t = sqlpp::make_char_sequence<sizeof(_literal), _literal>;
      template <typename T>
      struct _member_t {
        T value;
        T& operator()() { return value; }
        const T& operator()() const { return value; }
      };
    };
    using _traits = sqlpp::make_traits<sqlpp::varchar, sqlpp::tag::can_be_null>;
  };
  struct CreatedAt {
    struct _alias_t {
      static constexpr const char _literal[] = "created_at";
      using _name_t = sqlpp::make_char_sequence<sizeof(_literal), _literal>;
      template <typename T>
      struct _member_t {
        T created_at;
        T& operator()() { return created_at; }
        const T& operator()() const { return created_at; }
      };
    };
    using _traits = sqlpp::make_traits<sqlpp::time_point>;
  };
  struct UpdatedAt {
    struct _alias_t {
      static constexpr const char _literal[] = "updated_at";
      using _name_t = sqlpp::make_char_sequence<sizeof(_literal), _literal>;
      template <typename T>
      struct _member_t {
        T updated_at;
        T& operator()() { return updated_at; }
        const T& operator()() const { return updated_at; }
      };
    };
    using _traits = sqlpp::make_traits<sqlpp::time_point>;
  };
} // namespace TabUser_

struct TabUser : sqlpp::table_t<TabUser
       , TabUser_::Id 
       , TabUser_::Name 
       , TabUser_::Value 
       , TabUser_::CreatedAt 
       , TabUser_::UpdatedAt 
     >
{
  using _value_type = sqlpp::no_value_t;
  struct _alias_t {
    static constexpr const char _literal[] = "users";
    using _name_t = sqlpp::make_char_sequence<sizeof(_literal), _literal>;
    template <typename T>
    struct _member_t {
      T tabUser;
      T& operator()() { return tabUser; }
      const T& operator()() const { return tabUser; }
    };
  };
};

struct UserData {
  UserData() : id(0) {}
  std::int64_t                     id                       ; // false      integer
  std::string                      name                     ; // true       varchar
  std::string                      value                    ; // true       varchar
  sqlpp::chrono::microsecond_point created_at               ; // false      datetime
  sqlpp::chrono::microsecond_point updated_at               ; // false      datetime
};

#endif // SQLPP_TAB_USER_H

```

## Development

After checking out the repo, run `bin/setup` to install dependencies. Then, run `rake spec` to run the tests. You can also run `bin/console` for an interactive prompt that will allow you to experiment.

To install this gem onto your local machine, run `bundle exec rake install`. To release a new version, update the version number in `version.rb`, and then run `bundle exec rake release`, which will create a git tag for the version, push git commits and tags, and push the `.gem` file to [rubygems.org](https://rubygems.org).

## Contributing

Bug reports and pull requests are welcome on GitHub at https://github.com/[USERNAME]/sqlpp11gen. This project is intended to be a safe, welcoming space for collaboration, and contributors are expected to adhere to the [Contributor Covenant](contributor-covenant.org) code of conduct.


## License

The gem is available as open source under the terms of the [MIT License](http://opensource.org/licenses/MIT).

